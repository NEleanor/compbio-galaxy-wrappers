<tool id="combine_annotate" name="Annotate Fusions">
  <description>Combine Fusion Annotation Files for STAR-Fusion Annotate and add Cancer Specific Annotation</description>


  <command>/usr/bin/Rscript --vanilla $__tool_directory__/run_fusionannotation.R
   $starfusion
   $oncotated_left_output
   $oncotated_right_output
   $left_sequence
   $right_sequence
   $oncokbanno_table
   $oncokbaction_table
   $civic_table
  </command>
  
  <inputs>
      <param name="starfusion" type="data" format="tabular" label="star-fusion output" help="star-fusion.fusion_candidates.final.abridged.FFPM" />
      <param name="oncotated_left_output" type="data" format="tabular" label="oncotated_left_output" help="LEFT oncotator output" />
      <param name="oncotated_right_output" type="data" format="tabular" label="oncotated_right_output" help="RIGHT oncotator output" />
      <param name="left_sequence" type="data" format="tabular" label="left_sequence" help="left_sequence.txt"/>
      <param name="right_sequence" type="data" format="tabular" label="right_sequence" help="right_sequence.txt" />
      <param name="oncokbanno_table" type="data" format="tabular" label="ONCOKB Annotated Variants Table" help="allAnnotatedVariants.txt" />
      <param name="oncokbaction_table" type="data" format="tabular" label="ONCOKB Actionable Variants Table" help="allActionableVariants.txt" />
      <param name="civic_table" type="data" format="tabular" label="CIVIC Table" help="01-Mar-2017-ClinicalEvidenceSummaries.tsv" />
  </inputs>
  <outputs>
     <data name="fusions_annotated.txt" format="tabular" label="${tool.name} on ${on_string}: fusions_annotated.txt" from_work_dir= "fusions_annotated.txt"/>
     
  </outputs>

  <help>
    This tool combines the annotation for fusions in to fusions_annotated.bedpe. Annotated STAR-Fusion calls OncoKB and CIVIC and combine with Oncotator output and up/downstream sequences from the Make Fusion Annotation Files Tool.

Annotation Databases in R script
--------------------------------
Combine Oncotator queries and sequence information and annotated with OncoKB and CIVIC


Annotations Columns
-------------------
  * oncotatorleft_HGNC_RefSeq IDs = Left RefseqIDs from oncotator. If no NM number NG is present
  * oncotatorleft_transcript_exon = Left Transcript Exon from oncotator
  * oncotatorleft_COSMIC_FusionGenes_fusion_genes = Left Overlapping COSMIC Fusion genes from oncotator
  * oncotatorright_HGNC_RefSeq IDs = Right RefseqIDs from oncotator. If no NM number NG is present
  * oncotatorright_transcript_exon = Right Transcript Exon from oncotator
  * oncotatorright_COSMIC_FusionGenes_fusion_genes = Right Overlapping COSMIC Fusion genes from oncotator
  * seq_left = upstream fusion sequence
  * seq_right = downstream fusion sequence
  * ONCOKB_Gene = OncoKB (http://oncokb.org/#/) two lists were combined (ActionableVariants.txt and AnnotatedVariant.txt)
  * ONCOKB_Alteration = Variant
  * ONCOKB_Cancer.Type.or.Oncogenicity = CancerType(ActionableVariants), Oncogenecity(AnnotatedVariants)
  * ONCOKB_Level.or.MutationEffect = Level of Evidence http://oncokb.org/#/levels(ActionableVariants), Mutation Effect (AnnotatedVariants)
  * ONCOKB_Drugs.s. = Actionable Variants only
  * ONCOKB_PMIDs.for.drug.or.mutationeffect = PMID for drugs (ActionableVariants), PMID for Mutation Effect  (AnnotatedVariants)
  * ONCOKB_Abstracts.for.drug.or.mutationeffect = Abstract for drugs (ActionableVariants), Abstract for Mutation Effect  (AnnotatedVariants)
  * ONCOKB_table = Actionable/Annoatated table
  * CIVIC_variant = CIVIC (https://civic.genome.wustl.edu/#/home), duplicated fusion variants have comma separated were combined annotation
  * CIVIC_gene
  * CIVIC_entrez_id
  * CIVIC_disease
  * CIVIC_doid
  * CIVIC_drugs
  * CIVIC_evidence_type
  * CIVIC_evidence_direction
  * CIVIC_evidence_level
  * CIVIC_clinical_significance
  * CIVIC_evidence_statement
  * CIVIC_pubmed_id
  * CIVIC_citation
  * CIVIC_rating
  * CIVIC_evidence_status
  * CIVIC_evidence_id
  * CIVIC_variant_id
  * CIVIC_gene_id
  * CIVIC_chromosome
  * CIVIC_start
  * CIVIC_stop
  * CIVIC_reference_bases
  * CIVIC_variant_bases
  * CIVIC_representative_transcript
  * CIVIC_chromosome2
  * CIVIC_start2
  * CIVIC_stop2
  * CIVIC_representative_transcript2
  * CIVIC_ensembl_version
  * CIVIC_reference_build
  * CIVIC_variant_summary
  * CIVIC_variant_origin
  * CIVIC_evidence_civic_url
  * CIVIC_variant_civic_url
  * CIVIC_gene_civic_url

  </help>

</tool>
