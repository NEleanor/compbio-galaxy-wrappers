<tool id="gatk4_filterbyorientationbias" name="FilterByOrientationBias" version="@VERSION@.0" profile="17.09">
    <description>- Filter Mutect2 somatic variant calls using the Orientation Bias Filter.</description>

    <macros>
        <import>macros.xml</import>
    </macros>

    @VERSION_CMD@

    <expand macro="requirements"/>

    <command detect_errors="exit_code"><![CDATA[
        @CMD_BEGIN@ FilterByOrientationBias

        --variant "${input}"
        --pre-adapter-detail-file "${pre_adapter_detail_file}"
        -O "variants.vcf"
        -AM "G/T"
        -AM "C/T"

    ]]></command>

    <inputs>
        <param name="input" type="data" format="vcf,vcf_bgzip" optional="false" label="Variant File" help="A VCF file containing variants"/>
        <param name="pre_adapter_detail_file" type="data" format="txt" optional="false" label="Metrics File" help="PreAdapter Detail metrics file. Usually, generated by CollectSequencingArtifactMetrics."/>
        <section name="filterbyorientationbias_opt" title="Optional FilterByOrientationBias Parameters" expanded="False" />
        <section name="filterbyorientationbias_advanced" title="Advanced FilterByOrientationBias Parameters" expanded="False" />
    </inputs>

    <outputs>
        <data format="vcf" name="output" label="${tool.name} on ${on_string}: VCF" from_work_dir="variants.vcf" />
        <data format="tabular" name="summary_metrics" label="${tool.name} on ${on_string}: SUMMARY METRICS" from_work_dir="variants.vcf.summary" />
    </outputs>

    <help><![CDATA[
    Filter Mutect2 somatic variant calls using the Orientation Bias Filter.
    Used for the OxoG (G/T) and Deamination (FFPE) (C/T) artifacts that get introduced into our SNV calling.

    Notes:  All variants are held in RAM.
    This tool will only catch artifacts in diploid organisms.
    - Triallelic sites may not be considered for filtering -- the behavior of this tool is undefined for triallelic sites.
    - If you do not wish to filter, you must skip the filter entirely.  You cannot do a dummy/non-filter operation with this
    tool.
    - Sites-only VCF files are NOT supported.  At least one sample must be present in the VCF file for any filtering to be
    done.  If no samples are present in the VCF file, no filtering annotation is actually performed.
    - This tool was tested only with output for GATK4 Mutect and makes assumptions about the existence of fields produced by
    GATK4 Mutect.
    - ALT_F1R2 and ALT_F2R1 tags must be present in all SNP variants.
    - Do NOT specify artifact modes that are reverse complements of each other.  Behavior of this tool is undefined when
    that happens.  For example, do not specify C/A and G/T in the same run.
    - Any variants that are filtered in the input file are not considered for filtering here, nor are these variants used in
    deciding cutoff.
    - The Orientation Bias puts a filter tag in both the genotype (FORMAT) and variant (FILTER) fields.
    - In multiallelic sites, only the first alternate allele is used for filtering.
    - This filter should be applied last in any M2 toolchain.
    - Common artifacts:
    G/T (OxoG)
    C/T (deamination)
    ]]></help>

    <expand macro="citations" />

</tool>
