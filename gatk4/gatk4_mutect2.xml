<tool id="gatk4_mutect2" name="Mutect2" version="@VERSION@.0" profile="17.09">
    <description>Call somatic SNVs and indels via local assembly of haplotypes</description>

    <macros>
        <import>macros.xml</import>
    </macros>

    @VERSION_CMD@

    <command detect_errors="exit_code"><![CDATA[
        #for $value, $interval in enumerate($intervals):
            ln -s ${interval} ${value}.interval_list &&
        #end for
        @CMD_BEGIN@ Mutect2

        #for $tumor_input in $tumor_inputs:
            -I "${tumor_input}"
        #end for
	    --tumor-sample "${tumor_sample}"

        #if $supply_normal.use_normal == "normal_yes":
            #for $normal_input in $supply_normal.normal_inputs:
                -I "${normal_input}"
            #end for
    	    --normal-sample "${normal_sample}"
        #end if
        -O ${output}

        #include source=$gatk_req_opts#
        #include source=$gatk_ival_opts#
        ##include source=$gakt_common_opts#

    ]]></command>

    <inputs>
	    <param name="tumor_inputs" type="data" label="Tumor Input" multiple="true" help="BAM/SAM/CRAM file containing reads"/>
        <conditional name="supply_normal">
            <param name="use_normal" type="select" label="Include a normal sample?">
                <option value="normal_yes">Yes</option>
                <option value="normal_no" selected="True">No</option>
            </param>
            <when value="normal_yes">
                <param name="normal_inputs" type="data" optional="true" label="Normal Input" multiple="true" help="BAM/SAM/CRAM file containing reads"/>
                <param name="normal_sample" type="text" label="BAM sample name of normal"/>
            </when>
        </conditional>
	    <param name="tumor_sample" type="text" label="BAM sample name of tumor"/>
        <expand macro="ref_sel"/>
        <expand macro="gatk_opt_params"/>
        <section name="mutect2_opt" title="Optional Mutect2 Parameters" expanded="False">
        </section>
        <section name="mutect2_advanced" title="Advanced Mutect2 Parameters" expanded="False">
        </section>
    </inputs>

    <outputs>
        <data format="vcf" name="output" label="${tool.name} on ${on_string}: Mutect2"/>
    </outputs>

    <help><![CDATA[
    ]]></help>

    <expand macro="citations" />

</tool>
